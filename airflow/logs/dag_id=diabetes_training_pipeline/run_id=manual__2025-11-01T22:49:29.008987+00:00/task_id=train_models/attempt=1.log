[2025-11-01T22:49:31.173+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: diabetes_training_pipeline.train_models manual__2025-11-01T22:49:29.008987+00:00 [queued]>
[2025-11-01T22:49:31.257+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: diabetes_training_pipeline.train_models manual__2025-11-01T22:49:29.008987+00:00 [queued]>
[2025-11-01T22:49:31.257+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2025-11-01T22:49:31.265+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): train_models> on 2025-11-01 22:49:29.008987+00:00
[2025-11-01T22:49:31.271+0000] {standard_task_runner.py:57} INFO - Started process 4515 to run task
[2025-11-01T22:49:31.274+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'diabetes_training_pipeline', 'train_models', 'manual__2025-11-01T22:49:29.008987+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/diabetes_training_pipeline.py', '--cfg-path', '/tmp/tmp072cavaf']
[2025-11-01T22:49:31.277+0000] {standard_task_runner.py:85} INFO - Job 12: Subtask train_models
[2025-11-01T22:49:31.310+0000] {task_command.py:416} INFO - Running <TaskInstance: diabetes_training_pipeline.train_models manual__2025-11-01T22:49:29.008987+00:00 [running]> on host abe2ec3976bd
[2025-11-01T22:49:31.353+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='mlops_team' AIRFLOW_CTX_DAG_ID='diabetes_training_pipeline' AIRFLOW_CTX_TASK_ID='train_models' AIRFLOW_CTX_EXECUTION_DATE='2025-11-01T22:49:29.008987+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-01T22:49:29.008987+00:00'
[2025-11-01T22:49:32.833+0000] {logging_mixin.py:154} WARNING - 2025/11/01 22:49:32 WARNING mlflow.utils.git_utils: Failed to import Git (the Git executable is probably not on your PATH), so Git SHA is not available. Error: Failed to initialize: Bad git executable.
The git executable must be specified in one of the following ways:
    - be included in your $PATH
    - be set via $GIT_PYTHON_GIT_EXECUTABLE
    - explicitly set via git.refresh(<full-path-to-git-executable>)

All git commands will error until this is rectified.

This initial message can be silenced or aggravated in the future by setting the
$GIT_PYTHON_REFRESH environment variable. Use one of the following values:
    - quiet|q|silence|s|silent|none|n|0: for no message or exception
    - warn|w|warning|log|l|1: for a warning message (logging level CRITICAL, displayed by default)
    - error|e|exception|raise|r|2: for a raised exception

Example:
    export GIT_PYTHON_REFRESH=quiet
[2025-11-01T22:49:37.826+0000] {logging_mixin.py:154} WARNING - 2025/11/01 22:49:37 WARNING mlflow.models.signature: Failed to infer the model signature from the input example. Reason: MlflowException("Unable to map 'object' type to MLflow DataType. object can be mapped iff all values have identical data type which is one of (string, (bytes or byterray),  int, float)."). To see the full traceback, set the logging level to DEBUG via `logging.getLogger("mlflow").setLevel(logging.DEBUG)`. To disable automatic signature inference, set `signature` to `False` in your `log_model` or `save_model` call.
[2025-11-01T22:49:40.810+0000] {logging_mixin.py:154} WARNING - /home/***/.local/lib/python3.10/site-packages/_distutils_hack/__init__.py:33 UserWarning: Setuptools is replacing distutils.
[2025-11-01T22:49:40.962+0000] {credentials.py:1147} INFO - Found credentials in environment variables.
[2025-11-01T22:49:41.666+0000] {logging_mixin.py:154} WARNING - Successfully registered model 'diabetes_readmit_logreg'.
[2025-11-01T22:49:41.777+0000] {logging_mixin.py:154} WARNING - 2025/11/01 22:49:41 INFO mlflow.store.model_registry.abstract_store: Waiting up to 300 seconds for model version to finish creation. Model name: diabetes_readmit_logreg, version 1
[2025-11-01T22:49:41.778+0000] {logging_mixin.py:154} WARNING - Created version '1' of model 'diabetes_readmit_logreg'.
[2025-11-01T22:49:52.806+0000] {logging_mixin.py:154} WARNING - 2025/11/01 22:49:52 WARNING mlflow.models.signature: Failed to infer the model signature from the input example. Reason: MlflowException("Unable to map 'object' type to MLflow DataType. object can be mapped iff all values have identical data type which is one of (string, (bytes or byterray),  int, float)."). To see the full traceback, set the logging level to DEBUG via `logging.getLogger("mlflow").setLevel(logging.DEBUG)`. To disable automatic signature inference, set `signature` to `False` in your `log_model` or `save_model` call.
[2025-11-01T22:49:55.863+0000] {logging_mixin.py:154} WARNING - Successfully registered model 'diabetes_readmit_gb'.
[2025-11-01T22:49:55.907+0000] {logging_mixin.py:154} WARNING - 2025/11/01 22:49:55 INFO mlflow.store.model_registry.abstract_store: Waiting up to 300 seconds for model version to finish creation. Model name: diabetes_readmit_gb, version 1
[2025-11-01T22:49:55.907+0000] {logging_mixin.py:154} WARNING - Created version '1' of model 'diabetes_readmit_gb'.
[2025-11-01T22:51:31.393+0000] {local_task_job_runner.py:294} WARNING - State of this instance has been externally set to queued. Terminating instance.
[2025-11-01T22:51:31.651+0000] {process_utils.py:131} INFO - Sending 15 to group 4515. PIDs of all processes in the group: [4515]
[2025-11-01T22:51:31.694+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 4515
[2025-11-01T22:51:31.804+0000] {taskinstance.py:1632} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-11-01T22:51:32.926+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/diabetes_training_pipeline.py", line 120, in train_models
    yv_pred = pipe.predict(X_valid)
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/pipeline.py", line 514, in predict
    Xt = transform.transform(Xt)
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/compose/_column_transformer.py", line 827, in transform
    Xs = self._fit_transform(
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/compose/_column_transformer.py", line 681, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/utils/parallel.py", line 65, in __call__
    return super().__call__(iterable_with_config)
  File "/home/airflow/.local/lib/python3.10/site-packages/joblib/parallel.py", line 1986, in __call__
    return output if self.return_generator else list(output)
  File "/home/airflow/.local/lib/python3.10/site-packages/joblib/parallel.py", line 1914, in _get_sequential_output
    res = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/utils/parallel.py", line 127, in __call__
    return self.function(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/pipeline.py", line 940, in _transform_one
    res = transformer.transform(X)
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/preprocessing/_encoders.py", line 1027, in transform
    X_int, X_mask = self._transform(
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/preprocessing/_encoders.py", line 226, in _transform
    X_int[:, i] = _encode(Xi, uniques=self.categories_[i], check_unknown=False)
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/utils/_encode.py", line 225, in _encode
    return _map_to_integer(values, uniques)
  File "/home/airflow/.local/lib/python3.10/site-packages/sklearn/utils/_encode.py", line 164, in _map_to_integer
    table = _nandict({val: i for i, val in enumerate(uniques)})
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 1634, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2025-11-01T22:51:33.105+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=diabetes_training_pipeline, task_id=train_models, execution_date=20251101T224929, start_date=20251101T224931, end_date=20251101T225133
[2025-11-01T22:51:33.278+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 12 for task train_models (Task received SIGTERM signal; 4515)
[2025-11-01T22:51:33.505+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=4515, status='terminated', exitcode=1, started='22:49:30') (4515) terminated with exit code 1
